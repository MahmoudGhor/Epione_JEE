<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
	<title>test chat</title>
</head>
<body>
	<textarea id="messages" readonly="readonly" rows="10" cols="45"></textarea><br>
	<input type="text" id="message" size="50" />
	<input type="button" value="send" onclick="send()" />

	<script type="text/javascript">
		var websocket = new WebSocket("ws://127.0.0.1:18080/Epione_JEE-web/chat");
		websocket.onmessage = function processMessage(messageData) {
			var json = JSON.parse(messageData.data);
			document.getElementById('messages').value += json.message+ '\n';
		};
		function send() {
			var message = document.getElementById('message');
			websocket.send(JSON.stringify({'message': message.value}));
			message.value="";
		};
		window.onbeforunload = function(){
			websocket.onclose = function () {};
			websocket.close();
		};
	</script>
</body>
</html>